/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { isPlatformBrowser } from '@angular/common';
import { Component, ContentChild, ContentChildren, ElementRef, EventEmitter, Inject, Input, Output, PLATFORM_ID, QueryList, Renderer2, TemplateRef, ViewChild, ViewEncapsulation, } from '@angular/core';
import { BehaviorSubject, fromEvent, interval, merge, Subject } from 'rxjs';
import { bufferCount, debounceTime, switchMap, takeUntil, tap } from 'rxjs/operators';
import { NgxHmCarouselItemDirective } from './ngx-hm-carousel-item.directive';
import { resizeObservable } from './rxjs.observable.resize';
// if the pane is paned .25, switch to the next pane.
const /** @type {?} */ PANBOUNDARY = 0.15;
export class NgxHmCarouselComponent {
    /**
     * @param {?} platformId
     * @param {?} _renderer
     */
    constructor(platformId, _renderer) {
        this.platformId = platformId;
        this._renderer = _renderer;
        this.aniTime = 400;
        this.align = 'center';
        this.infinite = false;
        this.mourseEnable = false;
        this.speed = 5000;
        this.delay = 8000;
        this.direction = 'right';
        this.scrollNum = 1;
        this.isDragMany = false;
        this.indexChanged = new EventEmitter();
        this.isFromAuto = true;
        this._currentIndex = 0;
        this._showNum = 1;
        this.isAutoNum = false;
        this._autoplay = false;
        this._porgressWidth = 0;
        this.alignDistance = 0;
        this.lastIndex = 0;
        this.elmWidth = 0;
        this.container_left = 0;
        this.mouseOnContainer = false;
        this.restart = new BehaviorSubject(null);
        this.stopEvent = new Subject();
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set showNum(value) {
        if (value === 'auto') {
            this.isAutoNum = true;
        }
        else {
            this._showNum = value;
        }
    }
    /**
     * @return {?}
     */
    get showNum() {
        return this._showNum;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set currentIndex(value) {
        // if now index if not equale to save index, do someting
        if (this.currentIndex !== value) {
            this._currentIndex = value;
            if (this.itemsElm) {
                if (this.autoplay && !this.isFromAuto) {
                    this.stopEvent.next();
                    this.restart.next(null);
                }
                this.drawView(this.currentIndex);
            }
        }
        this.isFromAuto = false;
    }
    /**
     * @return {?}
     */
    get currentIndex() {
        return this._currentIndex;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set autoplay(value) {
        if (isPlatformBrowser(this.platformId)) {
            if (this.itemsElm) {
                this.progressWidth = 0;
                if (value) {
                    this.doNextSub$ = this.doNext.subscribe();
                }
                else {
                    if (this.doNextSub$) {
                        this.doNextSub$.unsubscribe();
                    }
                }
            }
        }
        this._autoplay = value;
    }
    /**
     * @return {?}
     */
    get autoplay() {
        return this._autoplay;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set progressWidth(value) {
        if (this.progressElm !== undefined && this.autoplay) {
            this._porgressWidth = value;
        }
    }
    /**
     * @return {?}
     */
    get progressWidth() {
        return this._porgressWidth;
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        this.initVariable();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.setViewWidth(true);
        this.reSetVariable();
        this.hammer = this.bindHammer();
        this.drawView(this.currentIndex);
        this.bindClick();
        if (this.autoplay || this.infinite) {
            this.addInfiniteElm();
        }
        this.elmSub$ = resizeObservable(this.rootElm, () => this.containerResize()).subscribe();
    }
    /**
     * @return {?}
     */
    addInfiniteElm() {
        this.firstElm_clone = /** @type {?} */ (this.itemsElm[this.lastIndex].cloneNode(true));
        this.addStyle(this.firstElm_clone, {
            position: 'absolute',
            transform: 'translateX(-100%)'
        });
        this.LatestElm_clone = /** @type {?} */ (this.itemsElm[0].cloneNode(true));
        this.addStyle(this.LatestElm_clone, {
            position: 'absolute',
            right: 0,
            top: 0,
            transform: 'translateX(100%)'
        });
        this._renderer.insertBefore(this.containerElm, this.firstElm_clone, this.itemsElm[0]);
        this._renderer.appendChild(this.containerElm, this.LatestElm_clone);
    }
    /**
     * @return {?}
     */
    containerResize() {
        this.reSetVariable();
        this.setViewWidth();
        // 因為不能滑了，所以要回到第一個，以確保全部都有顯示
        if (this.showNum >= this.itemsElm.length) {
            this.currentIndex = 0;
        }
        this.drawView(this.currentIndex, false);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.btnNext && this.btnPrev) {
            this.nextListener();
            this.prevListener();
        }
        this.hammer.destroy();
        if (this.autoplay) {
            this.doNextSub$.unsubscribe();
        }
        this.elmSub$.unsubscribe();
    }
    /**
     * @param {?} i
     * @return {?}
     */
    setIndex(i) {
        this.currentIndex = i;
    }
    /**
     * @return {?}
     */
    initVariable() {
        this.rootElm = this.parentChild.nativeElement;
        this.containerElm = /** @type {?} */ (this.rootElm.children[0]);
        this.itemsElm = /** @type {?} */ (Array.from(this.containerElm.children));
        this.lastIndex = this.itemsElm.length - 1;
        if (this.dotElm) {
            this.dots = new Array(this.itemsElm.length);
        }
        let /** @type {?} */ startEvent = this.restart.asObservable();
        let /** @type {?} */ stopEvent = this.stopEvent.asObservable();
        if (this.mourseEnable) {
            startEvent = merge(startEvent, fromEvent(this.containerElm, 'mouseleave').pipe(tap(() => this.mouseOnContainer = false)));
            stopEvent = merge(stopEvent, fromEvent(this.containerElm, 'mouseover').pipe(tap(() => this.mouseOnContainer = true)));
        }
        this.doNext = startEvent.pipe(debounceTime(this.delay), switchMap(() => this.runProgress(20).pipe(tap(() => {
            this.isFromAuto = true;
            // console.log('next');
            if (this.direction === 'left') {
                this.currentIndex -= this.scrollNum;
            }
            else {
                this.currentIndex += this.scrollNum;
            }
        }), takeUntil(stopEvent.pipe(tap(() => this.progressWidth = 0))))));
        if (this.autoplay) {
            this.doNextSub$ = this.doNext.subscribe();
        }
    }
    /**
     * @return {?}
     */
    reSetVariable() {
        this.container_left = this.rootElm.getBoundingClientRect().left;
        if (this.showNum && this.showNum !== 1) {
            switch (this.align) {
                case 'center':
                    this.alignDistance = (this.rootElm.clientWidth - this.elmWidth) / 2;
                    break;
                case 'left':
                    this.alignDistance = 0;
                    break;
                case 'right':
                    this.alignDistance = this.rootElm.clientWidth - this.elmWidth;
                    break;
            }
        }
        // console.log(this.alignDistance);
    }
    /**
     * @param {?=} isInit
     * @return {?}
     */
    setViewWidth(isInit) {
        if (this.isAutoNum) {
            this._showNum = this.getAutoNum();
        }
        this._renderer.addClass(this.containerElm, 'grab');
        // when init check view has scroll bar
        const /** @type {?} */ totalWidth = 0;
        if (isInit) {
            // remain one elm height
            this._renderer.addClass(this.containerElm, 'ngx-hm-carousel-display-npwrap');
        }
        this.elmWidth = (totalWidth + this.rootElm.clientWidth) / this._showNum;
        this._renderer.removeClass(this.containerElm, 'ngx-hm-carousel-display-npwrap');
        this._renderer.setStyle(this.containerElm, 'width', `${this.elmWidth * this.itemsElm.length}px`);
        this._renderer.setStyle(this.containerElm, 'position', 'relative');
        this.itemsElm.forEach((elm, index) => {
            this._renderer.setStyle(elm, 'width', `${this.elmWidth}px`);
        });
        if (this.firstElm_clone) {
            this._renderer.setStyle(this.firstElm_clone, 'width', `${this.elmWidth}px`);
            this._renderer.setStyle(this.LatestElm_clone, 'width', `${this.elmWidth}px`);
        }
    }
    /**
     * @return {?}
     */
    bindHammer() {
        const /** @type {?} */ hm = new Hammer(this.containerElm);
        hm.get('pan').set({ direction: Hammer.DIRECTION_HORIZONTAL });
        hm.on('panleft panright panend tap', (e) => {
            this._renderer.removeClass(this.containerElm, 'transition');
            this._renderer.addClass(this.containerElm, 'grabbing');
            if (this.autoplay) {
                this.stopEvent.next();
            }
            // console.log(e.type);
            switch (e.type) {
                case 'tap':
                    this.callClick(e.center.x);
                    this.callRestart();
                    this._renderer.removeClass(this.containerElm, 'grabbing');
                    break;
                case 'panleft':
                case 'panright':
                    // 顯示總數量小於總數量，停止滑動
                    if (this.showNum >= this.itemsElm.length) {
                        this.hammer.stop(true);
                        return;
                    }
                    // console.log(e.deltaY);
                    this.prePanMove = false;
                    if (Math.abs(e.deltaY) > 50) {
                        return;
                    }
                    // Slow down at the first and last pane.
                    if (!(this.autoplay || this.infinite) && this.outOfBound(e.type)) {
                        e.deltaX *= 0.2;
                    }
                    this._renderer.setStyle(this.containerElm, 'left', `${-this.currentIndex * this.elmWidth + this.alignDistance + e.deltaX}px`);
                    if (!this.isDragMany) {
                        if (Math.abs(e.deltaX) > this.elmWidth * 0.5) {
                            if (e.deltaX > 0) {
                                this.currentIndex -= this.scrollNum;
                            }
                            else {
                                this.currentIndex += this.scrollNum;
                            }
                            this._renderer.removeClass(this.containerElm, 'grabbing');
                            this.callRestart();
                            this.hammer.stop(true);
                            // remember prv action, to avoid hammer stop, then click
                            this.prePanMove = true;
                        }
                    }
                    break;
                case 'panend':
                    this.callRestart();
                    this._renderer.removeClass(this.containerElm, 'grabbing');
                    if (Math.abs(e.deltaX) > this.elmWidth * PANBOUNDARY) {
                        const /** @type {?} */ moveNum = this.isDragMany ?
                            Math.ceil(Math.abs(e.deltaX) / this.elmWidth) : this.scrollNum;
                        let /** @type {?} */ prevIndex = this.currentIndex - moveNum;
                        let /** @type {?} */ nextIndex = this.currentIndex + moveNum;
                        // 如果不是無限循環，不能大於或小於
                        if (e.deltaX > 0) {
                            if (!(this.autoplay || this.infinite) && prevIndex < 0) {
                                prevIndex = 0;
                                this.drawView(0);
                            }
                            this.currentIndex = prevIndex;
                        }
                        else {
                            if (!(this.autoplay || this.infinite) && nextIndex > this.lastIndex - this._showNum + 1) {
                                nextIndex = this.lastIndex - this._showNum + 1;
                                this.drawView(nextIndex);
                            }
                            this.currentIndex = nextIndex;
                        }
                        break;
                    }
                    else {
                        if (!this.isDragMany && this.prePanMove) {
                            this.callClick(e.center.x);
                        }
                    }
                    // console.log(this.currentIndex);
                    this.drawView(this.currentIndex);
                    this.prePanMove = false;
                    break;
            }
        });
        return hm;
    }
    /**
     * @return {?}
     */
    bindClick() {
        if (this.btnNext && this.btnPrev) {
            this.nextListener = this._renderer.listen(this.btnNext.nativeElement, 'click', () => {
                this.currentIndex++;
            });
            this.prevListener = this._renderer.listen(this.btnPrev.nativeElement, 'click', () => {
                this.currentIndex--;
            });
        }
    }
    /**
     * @return {?}
     */
    callRestart() {
        if (this.autoplay && !this.mouseOnContainer) {
            this.restart.next(null);
        }
    }
    /**
     * @param {?} positionX
     * @return {?}
     */
    callClick(positionX) {
        // click position subtract the containerlef and alignDistance is the move distance
        const /** @type {?} */ toIndex = this.currentIndex + Math.floor((positionX - this.container_left - this.alignDistance) / this.elmWidth);
        const /** @type {?} */ elm = this.items.toArray()[toIndex];
        if (elm) {
            elm.clickEvent.emit(toIndex);
        }
    }
    /**
     * @param {?} index
     * @param {?=} isEmit
     * @return {?}
     */
    drawView(index, isEmit = true) {
        const /** @type {?} */ lastIndex = this.lastIndex;
        if (this.autoplay || this.infinite) {
            if (index < 0) {
                this._currentIndex = lastIndex;
            }
            else if (index > lastIndex) {
                this._currentIndex = 0;
            }
        }
        else {
            this._currentIndex = Math.max(0, Math.min(index, this.lastIndex));
        }
        // 只有當大於1才要移動
        if (this.itemsElm.length > 1) {
            const /** @type {?} */ leftDistance = (index * this.elmWidth) - this.alignDistance;
            this._renderer.setStyle(this.containerElm, 'left', `${-leftDistance}px`);
            if (isEmit) {
                this._renderer.addClass(this.containerElm, 'transition');
                this.indexChanged.emit(this.currentIndex);
            }
            else {
                this._renderer.removeClass(this.containerElm, 'transition');
            }
            // 如果是循環的，當動畫結束偷偷的跳到當前的index、left去
            this.InfiniteHandler(index, lastIndex);
        }
        else {
            this._renderer.setStyle(this.containerElm, 'left', `${this.alignDistance}px`);
        }
    }
    /**
     * @param {?} index
     * @param {?} lastIndex
     * @return {?}
     */
    InfiniteHandler(index, lastIndex) {
        if ((this.autoplay || this.infinite)) {
            setTimeout(() => {
                this._renderer.removeClass(this.containerElm, 'transition');
                // 如果是循環的，當動畫結束偷偷的跳到當前的index、left去
                let /** @type {?} */ distance = 0;
                if (index <= -1) {
                    distance = (lastIndex * this.elmWidth) - this.alignDistance;
                    this._renderer.setStyle(this.containerElm, 'left', `${-distance}px`);
                }
                else if (index > lastIndex) {
                    this._renderer.setStyle(this.containerElm, 'left', `0px`);
                }
            }, this.aniTime);
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    outOfBound(type) {
        switch (type) {
            case 'panleft':
                return this.currentIndex >= this.lastIndex - this._showNum + 1;
            case 'panright':
                return this.currentIndex <= 0;
        }
    }
    /**
     * @param {?} betweenTime
     * @return {?}
     */
    runProgress(betweenTime) {
        const /** @type {?} */ howTimes = this.speed / betweenTime;
        const /** @type {?} */ everyIncrease = 100 / this.speed * betweenTime;
        // console.log('progress');
        return interval(betweenTime).pipe(tap(t => {
            this.progressWidth = (t % howTimes) * everyIncrease;
        }), bufferCount(Math.round(this.speed / betweenTime), 0));
    }
    /**
     * @return {?}
     */
    getAutoNum() {
        const /** @type {?} */ initNum = 3;
        // 610
        const /** @type {?} */ width = this.rootElm.clientWidth;
        if (width > 300) {
            return Math.floor(initNum + (width / 200));
        }
        return initNum;
    }
    /**
     * @param {?} elm
     * @param {?} style
     * @return {?}
     */
    addStyle(elm, style) {
        if (style) {
            Object.keys(style).forEach((key) => {
                const /** @type {?} */ value = style[key];
                this._renderer.setStyle(elm, key, value);
            });
        }
    }
}
NgxHmCarouselComponent.decorators = [
    { type: Component, args: [{
                selector: 'ngx-hm-carousel',
                template: `<div #parentChild class="carousel">
  <ng-content select="[ngx-hm-carousel-container]"></ng-content>
  <!-- left -->
  <div #prev *ngIf="contentPrev"
    class="direction left">
    <ng-container *ngTemplateOutlet="contentPrev"></ng-container>
  </div>
  <!--  right -->
  <div #next *ngIf="contentNext"
    class="direction right">
    <ng-container *ngTemplateOutlet="contentNext"></ng-container>
  </div>
  <!-- indicators -->
  <ul class="indicators" *ngIf="dotElm">
    <li
      *ngFor="let dot of dots; let i = index;"
      (click)="setIndex(i)">
      <ng-container
        *ngTemplateOutlet="dotElm, context: {
          $implicit: {
            index : i,
            currentIndex : currentIndex
          }
        }">
      </ng-container>
    </li>
  </ul>
  <!-- progress -->
  <div *ngIf="progressElm && autoplay">
    <ng-container
      *ngTemplateOutlet="progressElm, context: {
        $implicit: {
          progress:progressWidth
        }
      }">
    </ng-container>
  </div>
</div>
`,
                styles: [`:host{display:block;height:100%}.ngx-hm-carousel-display-npwrap{display:flex!important;flex-wrap:nowrap!important;flex-direction:row!important;overflow:hidden!important}.carousel{overflow:hidden;position:relative;width:100%;height:100%}.carousel ul.indicators{list-style:none;bottom:1rem;left:0;margin:0;padding:0;position:absolute;text-align:center;width:100%}.carousel ul.indicators li{cursor:pointer;display:inline-block;position:relative;padding:.5rem}.carousel .direction{position:absolute;height:100%;display:flex;align-items:center;justify-content:center;top:0}.carousel .direction.left{left:0}.carousel .direction.right{position:absolute;right:0}.transition{transition:all .4s ease-in-out}.grab{cursor:-webkit-grab;cursor:grab}.grabbing{cursor:-webkit-grabbing;cursor:grabbing}.pointer{cursor:pointer}`],
                encapsulation: ViewEncapsulation.None
            },] },
];
/** @nocollapse */
NgxHmCarouselComponent.ctorParameters = () => [
    { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] },] },
    { type: Renderer2, },
];
NgxHmCarouselComponent.propDecorators = {
    "parentChild": [{ type: ViewChild, args: ['parentChild',] },],
    "btnPrev": [{ type: ViewChild, args: ['prev',] },],
    "btnNext": [{ type: ViewChild, args: ['next',] },],
    "items": [{ type: ContentChildren, args: [NgxHmCarouselItemDirective,] },],
    "contentPrev": [{ type: ContentChild, args: ['carouselPrev',] },],
    "contentNext": [{ type: ContentChild, args: ['carouselNext',] },],
    "dotElm": [{ type: ContentChild, args: ['carouselDot',] },],
    "progressElm": [{ type: ContentChild, args: ['carouselProgress',] },],
    "aniTime": [{ type: Input, args: ['aniTime',] },],
    "align": [{ type: Input, args: ['align',] },],
    "infinite": [{ type: Input, args: ['infinite',] },],
    "mourseEnable": [{ type: Input, args: ['mourse-enable',] },],
    "speed": [{ type: Input, args: ['autoplay-speed',] },],
    "delay": [{ type: Input, args: ['between-delay',] },],
    "direction": [{ type: Input, args: ['autoplay-direction',] },],
    "showNum": [{ type: Input, args: ['show-num',] },],
    "scrollNum": [{ type: Input, args: ['scroll-num',] },],
    "isDragMany": [{ type: Input, args: ['drag-many',] },],
    "currentIndex": [{ type: Input, args: ['current-index',] },],
    "autoplay": [{ type: Input, args: ['autoplay',] },],
    "indexChanged": [{ type: Output, args: ['index-change',] },],
};
function NgxHmCarouselComponent_tsickle_Closure_declarations() {
    /** @type {!Array<{type: !Function, args: (undefined|!Array<?>)}>} */
    NgxHmCarouselComponent.decorators;
    /**
     * @nocollapse
     * @type {function(): !Array<(null|{type: ?, decorators: (undefined|!Array<{type: !Function, args: (undefined|!Array<?>)}>)})>}
     */
    NgxHmCarouselComponent.ctorParameters;
    /** @type {!Object<string,!Array<{type: !Function, args: (undefined|!Array<?>)}>>} */
    NgxHmCarouselComponent.propDecorators;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.parentChild;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.btnPrev;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.btnNext;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.items;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.contentPrev;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.contentNext;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.dotElm;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.progressElm;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.aniTime;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.align;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.infinite;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.mourseEnable;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.speed;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.delay;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.direction;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.scrollNum;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.isDragMany;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.indexChanged;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.isFromAuto;
    /** @type {?} */
    NgxHmCarouselComponent.prototype._currentIndex;
    /** @type {?} */
    NgxHmCarouselComponent.prototype._showNum;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.isAutoNum;
    /** @type {?} */
    NgxHmCarouselComponent.prototype._autoplay;
    /** @type {?} */
    NgxHmCarouselComponent.prototype._porgressWidth;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.rootElm;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.alignDistance;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.containerElm;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.itemsElm;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.lastIndex;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.hammer;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.elmWidth;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.container_left;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.mouseOnContainer;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.restart;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.stopEvent;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.doNext;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.doNextSub$;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.elmSub$;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.firstElm_clone;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.LatestElm_clone;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.prePanMove;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.dots;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.nextListener;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.prevListener;
    /** @type {?} */
    NgxHmCarouselComponent.prototype.platformId;
    /** @type {?} */
    NgxHmCarouselComponent.prototype._renderer;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWhtLWNhcm91c2VsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1obS1jYXJvdXNlbC8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtaG0tY2Fyb3VzZWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNwRCxPQUFPLEVBR0wsU0FBUyxFQUNULFlBQVksRUFDWixlQUFlLEVBQ2YsVUFBVSxFQUNWLFlBQVksRUFDWixNQUFNLEVBQ04sS0FBSyxFQUVMLE1BQU0sRUFDTixXQUFXLEVBQ1gsU0FBUyxFQUNULFNBQVMsRUFDVCxXQUFXLEVBQ1gsU0FBUyxFQUNULGlCQUFpQixHQUNsQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZUFBZSxFQUFjLFNBQVMsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBZ0IsTUFBTSxNQUFNLENBQUM7QUFDdEcsT0FBTyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV0RixPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUM5RSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQzs7QUFHNUQsdUJBQU0sV0FBVyxHQUFHLElBQUksQ0FBQztBQThDekIsTUFBTTs7Ozs7SUE2R0osWUFDK0IsWUFDckI7UUFEcUIsZUFBVSxHQUFWLFVBQVU7UUFDL0IsY0FBUyxHQUFULFNBQVM7dUJBckdTLEdBQUc7cUJBQ3NCLFFBQVE7d0JBQy9CLEtBQUs7NEJBQ0ksS0FBSztxQkFDWCxJQUFJO3FCQUNMLElBQUk7eUJBQ3VCLE9BQU87eUJBWWpDLENBQUM7MEJBQ0QsS0FBSzs0QkF1Q0MsSUFBSSxZQUFZLEVBQUU7MEJBVXBDLElBQUk7NkJBQ0QsQ0FBQzt3QkFDTixD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aEIsU0FBUyxTQUFDLE1BQU07c0JBQ2hCLGVBQWUsU0FBQywwQkFBMEI7NEJBQzFDLFlBQVksU0FBQyxjQUFjOzRCQUMzQixZQUFZLFNBQUMsY0FBYzt1QkFDM0IsWUFBWSxTQUFDLGFBQWE7NEJBQzFCLFlBQVksU0FBQyxrQkFBa0I7d0JBRS9CLEtBQUssU0FBQyxTQUFTO3NCQUNmLEtBQUssU0FBQyxPQUFPO3lCQUNiLEtBQUssU0FBQyxVQUFVOzZCQUNoQixLQUFLLFNBQUMsZUFBZTtzQkFDckIsS0FBSyxTQUFDLGdCQUFnQjtzQkFDdEIsS0FBSyxTQUFDLGVBQWU7MEJBQ3JCLEtBQUssU0FBQyxvQkFBb0I7d0JBQzFCLEtBQUssU0FBQyxVQUFVOzBCQVdoQixLQUFLLFNBQUMsWUFBWTsyQkFDbEIsS0FBSyxTQUFDLFdBQVc7NkJBQ2pCLEtBQUssU0FBQyxlQUFlO3lCQW9CckIsS0FBSyxTQUFDLFVBQVU7NkJBa0JoQixNQUFNLFNBQUMsY0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHtcclxuICBBZnRlckNvbnRlbnRJbml0LFxyXG4gIEFmdGVyVmlld0luaXQsXHJcbiAgQ29tcG9uZW50LFxyXG4gIENvbnRlbnRDaGlsZCxcclxuICBDb250ZW50Q2hpbGRyZW4sXHJcbiAgRWxlbWVudFJlZixcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgSW5qZWN0LFxyXG4gIElucHV0LFxyXG4gIE9uRGVzdHJveSxcclxuICBPdXRwdXQsXHJcbiAgUExBVEZPUk1fSUQsXHJcbiAgUXVlcnlMaXN0LFxyXG4gIFJlbmRlcmVyMixcclxuICBUZW1wbGF0ZVJlZixcclxuICBWaWV3Q2hpbGQsXHJcbiAgVmlld0VuY2Fwc3VsYXRpb24sXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgT2JzZXJ2YWJsZSwgZnJvbUV2ZW50LCBpbnRlcnZhbCwgbWVyZ2UsIFN1YmplY3QsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBidWZmZXJDb3VudCwgZGVib3VuY2VUaW1lLCBzd2l0Y2hNYXAsIHRha2VVbnRpbCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuaW1wb3J0IHsgTmd4SG1DYXJvdXNlbEl0ZW1EaXJlY3RpdmUgfSBmcm9tICcuL25neC1obS1jYXJvdXNlbC1pdGVtLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IHJlc2l6ZU9ic2VydmFibGUgfSBmcm9tICcuL3J4anMub2JzZXJ2YWJsZS5yZXNpemUnO1xyXG5cclxuLy8gaWYgdGhlIHBhbmUgaXMgcGFuZWQgLjI1LCBzd2l0Y2ggdG8gdGhlIG5leHQgcGFuZS5cclxuY29uc3QgUEFOQk9VTkRBUlkgPSAwLjE1O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICduZ3gtaG0tY2Fyb3VzZWwnLFxyXG4gIHRlbXBsYXRlOiBgPGRpdiAjcGFyZW50Q2hpbGQgY2xhc3M9XCJjYXJvdXNlbFwiPlxyXG4gIDxuZy1jb250ZW50IHNlbGVjdD1cIltuZ3gtaG0tY2Fyb3VzZWwtY29udGFpbmVyXVwiPjwvbmctY29udGVudD5cclxuICA8IS0tIGxlZnQgLS0+XHJcbiAgPGRpdiAjcHJldiAqbmdJZj1cImNvbnRlbnRQcmV2XCJcclxuICAgIGNsYXNzPVwiZGlyZWN0aW9uIGxlZnRcIj5cclxuICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJjb250ZW50UHJldlwiPjwvbmctY29udGFpbmVyPlxyXG4gIDwvZGl2PlxyXG4gIDwhLS0gIHJpZ2h0IC0tPlxyXG4gIDxkaXYgI25leHQgKm5nSWY9XCJjb250ZW50TmV4dFwiXHJcbiAgICBjbGFzcz1cImRpcmVjdGlvbiByaWdodFwiPlxyXG4gICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImNvbnRlbnROZXh0XCI+PC9uZy1jb250YWluZXI+XHJcbiAgPC9kaXY+XHJcbiAgPCEtLSBpbmRpY2F0b3JzIC0tPlxyXG4gIDx1bCBjbGFzcz1cImluZGljYXRvcnNcIiAqbmdJZj1cImRvdEVsbVwiPlxyXG4gICAgPGxpXHJcbiAgICAgICpuZ0Zvcj1cImxldCBkb3Qgb2YgZG90czsgbGV0IGkgPSBpbmRleDtcIlxyXG4gICAgICAoY2xpY2spPVwic2V0SW5kZXgoaSlcIj5cclxuICAgICAgPG5nLWNvbnRhaW5lclxyXG4gICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiZG90RWxtLCBjb250ZXh0OiB7XHJcbiAgICAgICAgICAkaW1wbGljaXQ6IHtcclxuICAgICAgICAgICAgaW5kZXggOiBpLFxyXG4gICAgICAgICAgICBjdXJyZW50SW5kZXggOiBjdXJyZW50SW5kZXhcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XCI+XHJcbiAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgPC9saT5cclxuICA8L3VsPlxyXG4gIDwhLS0gcHJvZ3Jlc3MgLS0+XHJcbiAgPGRpdiAqbmdJZj1cInByb2dyZXNzRWxtICYmIGF1dG9wbGF5XCI+XHJcbiAgICA8bmctY29udGFpbmVyXHJcbiAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwicHJvZ3Jlc3NFbG0sIGNvbnRleHQ6IHtcclxuICAgICAgICAkaW1wbGljaXQ6IHtcclxuICAgICAgICAgIHByb2dyZXNzOnByb2dyZXNzV2lkdGhcclxuICAgICAgICB9XHJcbiAgICAgIH1cIj5cclxuICAgIDwvbmctY29udGFpbmVyPlxyXG4gIDwvZGl2PlxyXG48L2Rpdj5cclxuYCxcclxuICBzdHlsZXM6IFtgOmhvc3R7ZGlzcGxheTpibG9jaztoZWlnaHQ6MTAwJX0ubmd4LWhtLWNhcm91c2VsLWRpc3BsYXktbnB3cmFwe2Rpc3BsYXk6ZmxleCFpbXBvcnRhbnQ7ZmxleC13cmFwOm5vd3JhcCFpbXBvcnRhbnQ7ZmxleC1kaXJlY3Rpb246cm93IWltcG9ydGFudDtvdmVyZmxvdzpoaWRkZW4haW1wb3J0YW50fS5jYXJvdXNlbHtvdmVyZmxvdzpoaWRkZW47cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJX0uY2Fyb3VzZWwgdWwuaW5kaWNhdG9yc3tsaXN0LXN0eWxlOm5vbmU7Ym90dG9tOjFyZW07bGVmdDowO21hcmdpbjowO3BhZGRpbmc6MDtwb3NpdGlvbjphYnNvbHV0ZTt0ZXh0LWFsaWduOmNlbnRlcjt3aWR0aDoxMDAlfS5jYXJvdXNlbCB1bC5pbmRpY2F0b3JzIGxpe2N1cnNvcjpwb2ludGVyO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOnJlbGF0aXZlO3BhZGRpbmc6LjVyZW19LmNhcm91c2VsIC5kaXJlY3Rpb257cG9zaXRpb246YWJzb2x1dGU7aGVpZ2h0OjEwMCU7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3RvcDowfS5jYXJvdXNlbCAuZGlyZWN0aW9uLmxlZnR7bGVmdDowfS5jYXJvdXNlbCAuZGlyZWN0aW9uLnJpZ2h0e3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjB9LnRyYW5zaXRpb257dHJhbnNpdGlvbjphbGwgLjRzIGVhc2UtaW4tb3V0fS5ncmFie2N1cnNvcjotd2Via2l0LWdyYWI7Y3Vyc29yOmdyYWJ9LmdyYWJiaW5ne2N1cnNvcjotd2Via2l0LWdyYWJiaW5nO2N1cnNvcjpncmFiYmluZ30ucG9pbnRlcntjdXJzb3I6cG9pbnRlcn1gXSxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOZ3hIbUNhcm91c2VsQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJDb250ZW50SW5pdCwgT25EZXN0cm95IHtcclxuICBAVmlld0NoaWxkKCdwYXJlbnRDaGlsZCcpIHBhcmVudENoaWxkO1xyXG4gIEBWaWV3Q2hpbGQoJ3ByZXYnKSBwcml2YXRlIGJ0blByZXY6IEVsZW1lbnRSZWY7XHJcbiAgQFZpZXdDaGlsZCgnbmV4dCcpIHByaXZhdGUgYnRuTmV4dDogRWxlbWVudFJlZjtcclxuICBAQ29udGVudENoaWxkcmVuKE5neEhtQ2Fyb3VzZWxJdGVtRGlyZWN0aXZlKSBpdGVtczogUXVlcnlMaXN0PE5neEhtQ2Fyb3VzZWxJdGVtRGlyZWN0aXZlPjtcclxuICBAQ29udGVudENoaWxkKCdjYXJvdXNlbFByZXYnKSBjb250ZW50UHJldjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAQ29udGVudENoaWxkKCdjYXJvdXNlbE5leHQnKSBjb250ZW50TmV4dDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAQ29udGVudENoaWxkKCdjYXJvdXNlbERvdCcpIGRvdEVsbTogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAQ29udGVudENoaWxkKCdjYXJvdXNlbFByb2dyZXNzJykgcHJvZ3Jlc3NFbG06IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gIEBJbnB1dCgnYW5pVGltZScpIGFuaVRpbWUgPSA0MDA7XHJcbiAgQElucHV0KCdhbGlnbicpIGFsaWduOiAnbGVmdCcgfCAnY2VudGVyJyB8ICdyaWdodCcgPSAnY2VudGVyJztcclxuICBASW5wdXQoJ2luZmluaXRlJykgaW5maW5pdGUgPSBmYWxzZTtcclxuICBASW5wdXQoJ21vdXJzZS1lbmFibGUnKSBtb3Vyc2VFbmFibGUgPSBmYWxzZTtcclxuICBASW5wdXQoJ2F1dG9wbGF5LXNwZWVkJykgc3BlZWQgPSA1MDAwO1xyXG4gIEBJbnB1dCgnYmV0d2Vlbi1kZWxheScpIGRlbGF5ID0gODAwMDtcclxuICBASW5wdXQoJ2F1dG9wbGF5LWRpcmVjdGlvbicpIGRpcmVjdGlvbjogJ2xlZnQnIHwgJ3JpZ2h0JyA9ICdyaWdodCc7XHJcbiAgQElucHV0KCdzaG93LW51bScpXHJcbiAgc2V0IHNob3dOdW0odmFsdWU6IG51bWJlciB8ICdhdXRvJykge1xyXG4gICAgaWYgKHZhbHVlID09PSAnYXV0bycpIHtcclxuICAgICAgdGhpcy5pc0F1dG9OdW0gPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd051bSA9IHZhbHVlO1xyXG4gICAgfVxyXG4gIH1cclxuICBnZXQgc2hvd051bSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9zaG93TnVtO1xyXG4gIH1cclxuICBASW5wdXQoJ3Njcm9sbC1udW0nKSBzY3JvbGxOdW0gPSAxO1xyXG4gIEBJbnB1dCgnZHJhZy1tYW55JykgaXNEcmFnTWFueSA9IGZhbHNlO1xyXG4gIEBJbnB1dCgnY3VycmVudC1pbmRleCcpXHJcbiAgc2V0IGN1cnJlbnRJbmRleCh2YWx1ZSkge1xyXG4gICAgLy8gaWYgbm93IGluZGV4IGlmIG5vdCBlcXVhbGUgdG8gc2F2ZSBpbmRleCwgZG8gc29tZXRpbmdcclxuICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCAhPT0gdmFsdWUpIHtcclxuICAgICAgdGhpcy5fY3VycmVudEluZGV4ID0gdmFsdWU7XHJcblxyXG4gICAgICBpZiAodGhpcy5pdGVtc0VsbSkge1xyXG4gICAgICAgIGlmICh0aGlzLmF1dG9wbGF5ICYmICF0aGlzLmlzRnJvbUF1dG8pIHtcclxuICAgICAgICAgIHRoaXMuc3RvcEV2ZW50Lm5leHQoKTtcclxuICAgICAgICAgIHRoaXMucmVzdGFydC5uZXh0KG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRyYXdWaWV3KHRoaXMuY3VycmVudEluZGV4KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5pc0Zyb21BdXRvID0gZmFsc2U7XHJcbiAgfVxyXG4gIGdldCBjdXJyZW50SW5kZXgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VycmVudEluZGV4O1xyXG4gIH1cclxuXHJcbiAgQElucHV0KCdhdXRvcGxheScpXHJcbiAgc2V0IGF1dG9wbGF5KHZhbHVlKSB7XHJcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICBpZiAodGhpcy5pdGVtc0VsbSkge1xyXG4gICAgICAgIHRoaXMucHJvZ3Jlc3NXaWR0aCA9IDA7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICB0aGlzLmRvTmV4dFN1YiQgPSB0aGlzLmRvTmV4dC5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHRoaXMuZG9OZXh0U3ViJCkgeyB0aGlzLmRvTmV4dFN1YiQudW5zdWJzY3JpYmUoKTsgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5fYXV0b3BsYXkgPSB2YWx1ZTtcclxuICB9XHJcbiAgZ2V0IGF1dG9wbGF5KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2F1dG9wbGF5O1xyXG4gIH1cclxuXHJcbiAgQE91dHB1dCgnaW5kZXgtY2hhbmdlJykgaW5kZXhDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIHNldCBwcm9ncmVzc1dpZHRoKHZhbHVlKSB7XHJcbiAgICBpZiAodGhpcy5wcm9ncmVzc0VsbSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuYXV0b3BsYXkpIHtcclxuICAgICAgdGhpcy5fcG9yZ3Jlc3NXaWR0aCA9IHZhbHVlO1xyXG4gICAgfVxyXG4gIH1cclxuICBnZXQgcHJvZ3Jlc3NXaWR0aCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9wb3JncmVzc1dpZHRoO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpc0Zyb21BdXRvID0gdHJ1ZTtcclxuICBwcml2YXRlIF9jdXJyZW50SW5kZXggPSAwO1xyXG4gIHByaXZhdGUgX3Nob3dOdW0gPSAxO1xyXG4gIHByaXZhdGUgaXNBdXRvTnVtID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBfYXV0b3BsYXkgPSBmYWxzZTtcclxuICBwcml2YXRlIF9wb3JncmVzc1dpZHRoID0gMDtcclxuXHJcbiAgcHJpdmF0ZSByb290RWxtOiBIVE1MRWxlbWVudDtcclxuICBwcml2YXRlIGFsaWduRGlzdGFuY2UgPSAwO1xyXG4gIHByaXZhdGUgY29udGFpbmVyRWxtOiBIVE1MRWxlbWVudDtcclxuICBwcml2YXRlIGl0ZW1zRWxtOiBBcnJheTxIVE1MRWxlbWVudD47XHJcbiAgcHJpdmF0ZSBsYXN0SW5kZXggPSAwO1xyXG4gIHByaXZhdGUgaGFtbWVyOiBIYW1tZXJNYW5hZ2VyO1xyXG4gIHByaXZhdGUgZWxtV2lkdGggPSAwO1xyXG4gIHByaXZhdGUgY29udGFpbmVyX2xlZnQgPSAwO1xyXG5cclxuICBwcml2YXRlIG1vdXNlT25Db250YWluZXIgPSBmYWxzZTtcclxuICBwcml2YXRlIHJlc3RhcnQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGFueT4obnVsbCk7XHJcbiAgcHJpdmF0ZSBzdG9wRXZlbnQgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcblxyXG4gIHByaXZhdGUgZG9OZXh0OiBPYnNlcnZhYmxlPGFueT47XHJcbiAgcHJpdmF0ZSBkb05leHRTdWIkOiBTdWJzY3JpcHRpb247XHJcbiAgcHJpdmF0ZSBlbG1TdWIkOiBTdWJzY3JpcHRpb247XHJcblxyXG4gIHByaXZhdGUgZmlyc3RFbG1fY2xvbmU7XHJcbiAgcHJpdmF0ZSBMYXRlc3RFbG1fY2xvbmU7XHJcbiAgcHJpdmF0ZSBwcmVQYW5Nb3ZlOiBib29sZWFuO1xyXG4gIHB1YmxpYyBkb3RzOiBBcnJheTxudW1iZXI+O1xyXG4gIHByaXZhdGUgbmV4dExpc3RlbmVyOiAoKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgcHJldkxpc3RlbmVyOiAoKSA9PiB2b2lkO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0LFxyXG4gICAgcHJpdmF0ZSBfcmVuZGVyZXI6IFJlbmRlcmVyMikgeyB9XHJcblxyXG4gIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuaW5pdFZhcmlhYmxlKCk7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICB0aGlzLnNldFZpZXdXaWR0aCh0cnVlKTtcclxuICAgIHRoaXMucmVTZXRWYXJpYWJsZSgpO1xyXG4gICAgdGhpcy5oYW1tZXIgPSB0aGlzLmJpbmRIYW1tZXIoKTtcclxuICAgIHRoaXMuZHJhd1ZpZXcodGhpcy5jdXJyZW50SW5kZXgpO1xyXG4gICAgdGhpcy5iaW5kQ2xpY2soKTtcclxuXHJcbiAgICBpZiAodGhpcy5hdXRvcGxheSB8fCB0aGlzLmluZmluaXRlKSB7XHJcbiAgICAgIHRoaXMuYWRkSW5maW5pdGVFbG0oKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmVsbVN1YiQgPSByZXNpemVPYnNlcnZhYmxlKHRoaXMucm9vdEVsbSwgKCkgPT4gdGhpcy5jb250YWluZXJSZXNpemUoKSkuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZEluZmluaXRlRWxtKCkge1xyXG4gICAgdGhpcy5maXJzdEVsbV9jbG9uZSA9IHRoaXMuaXRlbXNFbG1bdGhpcy5sYXN0SW5kZXhdLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIHRoaXMuYWRkU3R5bGUodGhpcy5maXJzdEVsbV9jbG9uZSwge1xyXG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWCgtMTAwJSknXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgdGhpcy5MYXRlc3RFbG1fY2xvbmUgPSB0aGlzLml0ZW1zRWxtWzBdLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIHRoaXMuYWRkU3R5bGUodGhpcy5MYXRlc3RFbG1fY2xvbmUsIHtcclxuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXHJcbiAgICAgIHJpZ2h0OiAwLFxyXG4gICAgICB0b3A6IDAsXHJcbiAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVgoMTAwJSknXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJlci5pbnNlcnRCZWZvcmUodGhpcy5jb250YWluZXJFbG0sIHRoaXMuZmlyc3RFbG1fY2xvbmUsIHRoaXMuaXRlbXNFbG1bMF0pO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXJFbG0sIHRoaXMuTGF0ZXN0RWxtX2Nsb25lKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29udGFpbmVyUmVzaXplKCkge1xyXG4gICAgdGhpcy5yZVNldFZhcmlhYmxlKCk7XHJcbiAgICB0aGlzLnNldFZpZXdXaWR0aCgpO1xyXG5cclxuICAgIC8vIOWboOeCuuS4jeiDvea7keS6hu+8jOaJgOS7peimgeWbnuWIsOesrOS4gOWAi++8jOS7peeiuuS/neWFqOmDqOmDveaciemhr+ekulxyXG4gICAgaWYgKHRoaXMuc2hvd051bSA+PSB0aGlzLml0ZW1zRWxtLmxlbmd0aCkge1xyXG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7XHJcbiAgICB9XHJcbiAgICB0aGlzLmRyYXdWaWV3KHRoaXMuY3VycmVudEluZGV4LCBmYWxzZSk7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpIHtcclxuICAgIGlmICh0aGlzLmJ0bk5leHQgJiYgdGhpcy5idG5QcmV2KSB7XHJcbiAgICAgIHRoaXMubmV4dExpc3RlbmVyKCk7XHJcbiAgICAgIHRoaXMucHJldkxpc3RlbmVyKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmhhbW1lci5kZXN0cm95KCk7XHJcbiAgICBpZiAodGhpcy5hdXRvcGxheSkge1xyXG4gICAgICB0aGlzLmRvTmV4dFN1YiQudW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmVsbVN1YiQudW5zdWJzY3JpYmUoKTtcclxuICB9XHJcblxyXG4gIHNldEluZGV4KGkpIHtcclxuICAgIHRoaXMuY3VycmVudEluZGV4ID0gaTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgaW5pdFZhcmlhYmxlKCkge1xyXG4gICAgdGhpcy5yb290RWxtID0gdGhpcy5wYXJlbnRDaGlsZC5uYXRpdmVFbGVtZW50O1xyXG4gICAgdGhpcy5jb250YWluZXJFbG0gPSB0aGlzLnJvb3RFbG0uY2hpbGRyZW5bMF0gYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICB0aGlzLml0ZW1zRWxtID0gQXJyYXkuZnJvbSh0aGlzLmNvbnRhaW5lckVsbS5jaGlsZHJlbikgYXMgSFRNTEVsZW1lbnRbXTtcclxuICAgIHRoaXMubGFzdEluZGV4ID0gdGhpcy5pdGVtc0VsbS5sZW5ndGggLSAxO1xyXG5cclxuICAgIGlmICh0aGlzLmRvdEVsbSkge1xyXG4gICAgICB0aGlzLmRvdHMgPSBuZXcgQXJyYXkodGhpcy5pdGVtc0VsbS5sZW5ndGgpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBzdGFydEV2ZW50ID0gdGhpcy5yZXN0YXJ0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgbGV0IHN0b3BFdmVudCA9IHRoaXMuc3RvcEV2ZW50LmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgaWYgKHRoaXMubW91cnNlRW5hYmxlKSB7XHJcbiAgICAgIHN0YXJ0RXZlbnQgPSBtZXJnZShcclxuICAgICAgICBzdGFydEV2ZW50LFxyXG4gICAgICAgIGZyb21FdmVudCh0aGlzLmNvbnRhaW5lckVsbSwgJ21vdXNlbGVhdmUnKS5waXBlKFxyXG4gICAgICAgICAgdGFwKCgpID0+IHRoaXMubW91c2VPbkNvbnRhaW5lciA9IGZhbHNlKVxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgICAgc3RvcEV2ZW50ID0gbWVyZ2UoXHJcbiAgICAgICAgc3RvcEV2ZW50LFxyXG4gICAgICAgIGZyb21FdmVudCh0aGlzLmNvbnRhaW5lckVsbSwgJ21vdXNlb3ZlcicpLnBpcGUoXHJcbiAgICAgICAgICB0YXAoKCkgPT4gdGhpcy5tb3VzZU9uQ29udGFpbmVyID0gdHJ1ZSlcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5kb05leHQgPSBzdGFydEV2ZW50LnBpcGUoXHJcbiAgICAgIGRlYm91bmNlVGltZSh0aGlzLmRlbGF5KSxcclxuICAgICAgc3dpdGNoTWFwKCgpID0+XHJcbiAgICAgICAgdGhpcy5ydW5Qcm9ncmVzcygyMCkucGlwZShcclxuICAgICAgICAgIHRhcCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNGcm9tQXV0byA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCduZXh0Jyk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRpcmVjdGlvbiA9PT0gJ2xlZnQnKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggLT0gdGhpcy5zY3JvbGxOdW07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggKz0gdGhpcy5zY3JvbGxOdW07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgdGFrZVVudGlsKHN0b3BFdmVudC5waXBlKHRhcCgoKSA9PiB0aGlzLnByb2dyZXNzV2lkdGggPSAwKSlcclxuICAgICAgICAgIClcclxuICAgICAgICApXHJcbiAgICAgICkpO1xyXG5cclxuICAgIGlmICh0aGlzLmF1dG9wbGF5KSB7XHJcbiAgICAgIHRoaXMuZG9OZXh0U3ViJCA9IHRoaXMuZG9OZXh0LnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZVNldFZhcmlhYmxlKCkge1xyXG4gICAgdGhpcy5jb250YWluZXJfbGVmdCA9IHRoaXMucm9vdEVsbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xyXG4gICAgaWYgKHRoaXMuc2hvd051bSAmJiB0aGlzLnNob3dOdW0gIT09IDEpIHtcclxuICAgICAgc3dpdGNoICh0aGlzLmFsaWduKSB7XHJcbiAgICAgICAgY2FzZSAnY2VudGVyJzpcclxuICAgICAgICAgIHRoaXMuYWxpZ25EaXN0YW5jZSA9ICh0aGlzLnJvb3RFbG0uY2xpZW50V2lkdGggLSB0aGlzLmVsbVdpZHRoKSAvIDI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgIHRoaXMuYWxpZ25EaXN0YW5jZSA9IDA7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgICB0aGlzLmFsaWduRGlzdGFuY2UgPSB0aGlzLnJvb3RFbG0uY2xpZW50V2lkdGggLSB0aGlzLmVsbVdpZHRoO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuYWxpZ25EaXN0YW5jZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFZpZXdXaWR0aChpc0luaXQ/OiBib29sZWFuKSB7XHJcbiAgICBpZiAodGhpcy5pc0F1dG9OdW0pIHtcclxuICAgICAgdGhpcy5fc2hvd051bSA9IHRoaXMuZ2V0QXV0b051bSgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5jb250YWluZXJFbG0sICdncmFiJyk7XHJcbiAgICAvLyB3aGVuIGluaXQgY2hlY2sgdmlldyBoYXMgc2Nyb2xsIGJhclxyXG4gICAgY29uc3QgdG90YWxXaWR0aCA9IDA7XHJcbiAgICBpZiAoaXNJbml0KSB7XHJcbiAgICAgIC8vIHJlbWFpbiBvbmUgZWxtIGhlaWdodFxyXG4gICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmNvbnRhaW5lckVsbSwgJ25neC1obS1jYXJvdXNlbC1kaXNwbGF5LW5wd3JhcCcpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5lbG1XaWR0aCA9ICh0b3RhbFdpZHRoICsgdGhpcy5yb290RWxtLmNsaWVudFdpZHRoKSAvIHRoaXMuX3Nob3dOdW07XHJcblxyXG4gICAgdGhpcy5fcmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5jb250YWluZXJFbG0sICduZ3gtaG0tY2Fyb3VzZWwtZGlzcGxheS1ucHdyYXAnKTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuY29udGFpbmVyRWxtLCAnd2lkdGgnLCBgJHt0aGlzLmVsbVdpZHRoICogdGhpcy5pdGVtc0VsbS5sZW5ndGh9cHhgKTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuY29udGFpbmVyRWxtLCAncG9zaXRpb24nLCAncmVsYXRpdmUnKTtcclxuICAgIHRoaXMuaXRlbXNFbG0uZm9yRWFjaCgoZWxtOiBIVE1MRWxlbWVudCwgaW5kZXgpID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZWxtLCAnd2lkdGgnLCBgJHt0aGlzLmVsbVdpZHRofXB4YCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAodGhpcy5maXJzdEVsbV9jbG9uZSkge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmZpcnN0RWxtX2Nsb25lLCAnd2lkdGgnLCBgJHt0aGlzLmVsbVdpZHRofXB4YCk7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuTGF0ZXN0RWxtX2Nsb25lLCAnd2lkdGgnLCBgJHt0aGlzLmVsbVdpZHRofXB4YCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGJpbmRIYW1tZXIoKSB7XHJcbiAgICBjb25zdCBobSA9IG5ldyBIYW1tZXIodGhpcy5jb250YWluZXJFbG0pO1xyXG4gICAgaG0uZ2V0KCdwYW4nKS5zZXQoeyBkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCB9KTtcclxuXHJcbiAgICBobS5vbigncGFubGVmdCBwYW5yaWdodCBwYW5lbmQgdGFwJywgKGU6IEhhbW1lcklucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMuY29udGFpbmVyRWxtLCAndHJhbnNpdGlvbicpO1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmNvbnRhaW5lckVsbSwgJ2dyYWJiaW5nJyk7XHJcbiAgICAgIGlmICh0aGlzLmF1dG9wbGF5KSB7XHJcbiAgICAgICAgdGhpcy5zdG9wRXZlbnQubmV4dCgpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKGUudHlwZSk7XHJcbiAgICAgIHN3aXRjaCAoZS50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAndGFwJzpcclxuICAgICAgICAgIHRoaXMuY2FsbENsaWNrKGUuY2VudGVyLngpO1xyXG4gICAgICAgICAgdGhpcy5jYWxsUmVzdGFydCgpO1xyXG4gICAgICAgICAgdGhpcy5fcmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5jb250YWluZXJFbG0sICdncmFiYmluZycpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncGFubGVmdCc6XHJcbiAgICAgICAgY2FzZSAncGFucmlnaHQnOlxyXG5cclxuICAgICAgICAgIC8vIOmhr+ekuue4veaVuOmHj+Wwj+aWvOe4veaVuOmHj++8jOWBnOatoua7keWLlVxyXG4gICAgICAgICAgaWYgKHRoaXMuc2hvd051bSA+PSB0aGlzLml0ZW1zRWxtLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmhhbW1lci5zdG9wKHRydWUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlLmRlbHRhWSk7XHJcbiAgICAgICAgICB0aGlzLnByZVBhbk1vdmUgPSBmYWxzZTtcclxuICAgICAgICAgIGlmIChNYXRoLmFicyhlLmRlbHRhWSkgPiA1MCkgeyByZXR1cm47IH1cclxuICAgICAgICAgIC8vIFNsb3cgZG93biBhdCB0aGUgZmlyc3QgYW5kIGxhc3QgcGFuZS5cclxuICAgICAgICAgIGlmICghKHRoaXMuYXV0b3BsYXkgfHwgdGhpcy5pbmZpbml0ZSkgJiYgdGhpcy5vdXRPZkJvdW5kKGUudHlwZSkpIHtcclxuICAgICAgICAgICAgZS5kZWx0YVggKj0gMC4yO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuY29udGFpbmVyRWxtLCAnbGVmdCcsIGAkey10aGlzLmN1cnJlbnRJbmRleCAqIHRoaXMuZWxtV2lkdGggKyB0aGlzLmFsaWduRGlzdGFuY2UgKyBlLmRlbHRhWH1weGApO1xyXG5cclxuICAgICAgICAgIGlmICghdGhpcy5pc0RyYWdNYW55KSB7XHJcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhlLmRlbHRhWCkgPiB0aGlzLmVsbVdpZHRoICogMC41KSB7XHJcbiAgICAgICAgICAgICAgaWYgKGUuZGVsdGFYID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggLT0gdGhpcy5zY3JvbGxOdW07XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ICs9IHRoaXMuc2Nyb2xsTnVtO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLmNvbnRhaW5lckVsbSwgJ2dyYWJiaW5nJyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5jYWxsUmVzdGFydCgpO1xyXG4gICAgICAgICAgICAgIHRoaXMuaGFtbWVyLnN0b3AodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgLy8gcmVtZW1iZXIgcHJ2IGFjdGlvbiwgdG8gYXZvaWQgaGFtbWVyIHN0b3AsIHRoZW4gY2xpY2tcclxuICAgICAgICAgICAgICB0aGlzLnByZVBhbk1vdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdwYW5lbmQnOlxyXG4gICAgICAgICAgdGhpcy5jYWxsUmVzdGFydCgpO1xyXG5cclxuICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMuY29udGFpbmVyRWxtLCAnZ3JhYmJpbmcnKTtcclxuICAgICAgICAgIGlmIChNYXRoLmFicyhlLmRlbHRhWCkgPiB0aGlzLmVsbVdpZHRoICogUEFOQk9VTkRBUlkpIHtcclxuICAgICAgICAgICAgY29uc3QgbW92ZU51bSA9IHRoaXMuaXNEcmFnTWFueSA/XHJcbiAgICAgICAgICAgICAgTWF0aC5jZWlsKE1hdGguYWJzKGUuZGVsdGFYKSAvIHRoaXMuZWxtV2lkdGgpIDogdGhpcy5zY3JvbGxOdW07XHJcblxyXG4gICAgICAgICAgICBsZXQgcHJldkluZGV4ID0gdGhpcy5jdXJyZW50SW5kZXggLSBtb3ZlTnVtO1xyXG4gICAgICAgICAgICBsZXQgbmV4dEluZGV4ID0gdGhpcy5jdXJyZW50SW5kZXggKyBtb3ZlTnVtO1xyXG5cclxuICAgICAgICAgICAgLy8g5aaC5p6c5LiN5piv54Sh6ZmQ5b6q55Kw77yM5LiN6IO95aSn5pa85oiW5bCP5pa8XHJcblxyXG4gICAgICAgICAgICBpZiAoZS5kZWx0YVggPiAwKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCEodGhpcy5hdXRvcGxheSB8fCB0aGlzLmluZmluaXRlKSAmJiBwcmV2SW5kZXggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBwcmV2SW5kZXggPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3VmlldygwKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gcHJldkluZGV4O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmICghKHRoaXMuYXV0b3BsYXkgfHwgdGhpcy5pbmZpbml0ZSkgJiYgbmV4dEluZGV4ID4gdGhpcy5sYXN0SW5kZXggLSB0aGlzLl9zaG93TnVtICsgMSkge1xyXG4gICAgICAgICAgICAgICAgbmV4dEluZGV4ID0gdGhpcy5sYXN0SW5kZXggLSB0aGlzLl9zaG93TnVtICsgMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZHJhd1ZpZXcobmV4dEluZGV4KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBuZXh0SW5kZXg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNEcmFnTWFueSAmJiB0aGlzLnByZVBhbk1vdmUpIHtcclxuICAgICAgICAgICAgICB0aGlzLmNhbGxDbGljayhlLmNlbnRlci54KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jdXJyZW50SW5kZXgpO1xyXG4gICAgICAgICAgdGhpcy5kcmF3Vmlldyh0aGlzLmN1cnJlbnRJbmRleCk7XHJcbiAgICAgICAgICB0aGlzLnByZVBhbk1vdmUgPSBmYWxzZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaG07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGJpbmRDbGljaygpIHtcclxuICAgIGlmICh0aGlzLmJ0bk5leHQgJiYgdGhpcy5idG5QcmV2KSB7XHJcbiAgICAgIHRoaXMubmV4dExpc3RlbmVyID0gdGhpcy5fcmVuZGVyZXIubGlzdGVuKHRoaXMuYnRuTmV4dC5uYXRpdmVFbGVtZW50LCAnY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SW5kZXgrKztcclxuICAgICAgfSk7XHJcbiAgICAgIHRoaXMucHJldkxpc3RlbmVyID0gdGhpcy5fcmVuZGVyZXIubGlzdGVuKHRoaXMuYnRuUHJldi5uYXRpdmVFbGVtZW50LCAnY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SW5kZXgtLTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGxSZXN0YXJ0KCkge1xyXG4gICAgaWYgKHRoaXMuYXV0b3BsYXkgJiYgIXRoaXMubW91c2VPbkNvbnRhaW5lcikge1xyXG4gICAgICB0aGlzLnJlc3RhcnQubmV4dChudWxsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsbENsaWNrKHBvc2l0aW9uWCkge1xyXG4gICAgLy8gY2xpY2sgcG9zaXRpb24gc3VidHJhY3QgdGhlIGNvbnRhaW5lcmxlZiBhbmQgYWxpZ25EaXN0YW5jZSBpcyB0aGUgbW92ZSBkaXN0YW5jZVxyXG4gICAgY29uc3QgdG9JbmRleCA9IHRoaXMuY3VycmVudEluZGV4ICsgTWF0aC5mbG9vcigocG9zaXRpb25YIC0gdGhpcy5jb250YWluZXJfbGVmdCAtIHRoaXMuYWxpZ25EaXN0YW5jZSkgLyB0aGlzLmVsbVdpZHRoKTtcclxuXHJcbiAgICBjb25zdCBlbG0gPSB0aGlzLml0ZW1zLnRvQXJyYXkoKVt0b0luZGV4XTtcclxuICAgIGlmIChlbG0pIHtcclxuICAgICAgZWxtLmNsaWNrRXZlbnQuZW1pdCh0b0luZGV4KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZHJhd1ZpZXcoaW5kZXg6IG51bWJlciwgaXNFbWl0ID0gdHJ1ZSkge1xyXG4gICAgY29uc3QgbGFzdEluZGV4ID0gdGhpcy5sYXN0SW5kZXg7XHJcblxyXG4gICAgaWYgKHRoaXMuYXV0b3BsYXkgfHwgdGhpcy5pbmZpbml0ZSkge1xyXG4gICAgICBpZiAoaW5kZXggPCAwKSB7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudEluZGV4ID0gbGFzdEluZGV4O1xyXG4gICAgICB9IGVsc2UgaWYgKGluZGV4ID4gbGFzdEluZGV4KSB7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudEluZGV4ID0gMDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fY3VycmVudEluZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oaW5kZXgsIHRoaXMubGFzdEluZGV4KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Y+q5pyJ55W25aSn5pa8MeaJjeimgeenu+WLlVxyXG4gICAgaWYgKHRoaXMuaXRlbXNFbG0ubGVuZ3RoID4gMSkge1xyXG4gICAgICBjb25zdCBsZWZ0RGlzdGFuY2UgPSAoaW5kZXggKiB0aGlzLmVsbVdpZHRoKSAtIHRoaXMuYWxpZ25EaXN0YW5jZTtcclxuXHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuY29udGFpbmVyRWxtLCAnbGVmdCcsIGAkey1sZWZ0RGlzdGFuY2V9cHhgKTtcclxuICAgICAgaWYgKGlzRW1pdCkge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRoaXMuY29udGFpbmVyRWxtLCAndHJhbnNpdGlvbicpO1xyXG4gICAgICAgIHRoaXMuaW5kZXhDaGFuZ2VkLmVtaXQodGhpcy5jdXJyZW50SW5kZXgpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMuY29udGFpbmVyRWxtLCAndHJhbnNpdGlvbicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDlpoLmnpzmmK/lvqrnkrDnmoTvvIznlbbli5XnlavntZDmnZ/lgbflgbfnmoTot7PliLDnlbbliY3nmoRpbmRleOOAgWxlZnTljrtcclxuICAgICAgdGhpcy5JbmZpbml0ZUhhbmRsZXIoaW5kZXgsIGxhc3RJbmRleCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmNvbnRhaW5lckVsbSwgJ2xlZnQnLCBgJHt0aGlzLmFsaWduRGlzdGFuY2V9cHhgKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIEluZmluaXRlSGFuZGxlcihpbmRleDogbnVtYmVyLCBsYXN0SW5kZXg6IG51bWJlcikge1xyXG4gICAgaWYgKCh0aGlzLmF1dG9wbGF5IHx8IHRoaXMuaW5maW5pdGUpKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMuY29udGFpbmVyRWxtLCAndHJhbnNpdGlvbicpO1xyXG4gICAgICAgIC8vIOWmguaenOaYr+W+queSsOeahO+8jOeVtuWLleeVq+e1kOadn+WBt+WBt+eahOi3s+WIsOeVtuWJjeeahGluZGV444CBbGVmdOWOu1xyXG4gICAgICAgIGxldCBkaXN0YW5jZSA9IDA7XHJcbiAgICAgICAgaWYgKGluZGV4IDw9IC0xKSB7XHJcbiAgICAgICAgICBkaXN0YW5jZSA9IChsYXN0SW5kZXggKiB0aGlzLmVsbVdpZHRoKSAtIHRoaXMuYWxpZ25EaXN0YW5jZTtcclxuICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuY29udGFpbmVyRWxtLCAnbGVmdCcsIGAkey1kaXN0YW5jZX1weGApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPiBsYXN0SW5kZXgpIHtcclxuICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuY29udGFpbmVyRWxtLCAnbGVmdCcsIGAwcHhgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIHRoaXMuYW5pVGltZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG91dE9mQm91bmQodHlwZSkge1xyXG4gICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgIGNhc2UgJ3BhbmxlZnQnOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRJbmRleCA+PSB0aGlzLmxhc3RJbmRleCAtIHRoaXMuX3Nob3dOdW0gKyAxO1xyXG4gICAgICBjYXNlICdwYW5yaWdodCc6XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEluZGV4IDw9IDA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJ1blByb2dyZXNzKGJldHdlZW5UaW1lKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IGhvd1RpbWVzID0gdGhpcy5zcGVlZCAvIGJldHdlZW5UaW1lO1xyXG4gICAgY29uc3QgZXZlcnlJbmNyZWFzZSA9IDEwMCAvIHRoaXMuc3BlZWQgKiBiZXR3ZWVuVGltZTtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdwcm9ncmVzcycpO1xyXG4gICAgcmV0dXJuIGludGVydmFsKGJldHdlZW5UaW1lKS5waXBlKFxyXG4gICAgICB0YXAodCA9PiB7XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzc1dpZHRoID0gKHQgJSBob3dUaW1lcykgKiBldmVyeUluY3JlYXNlO1xyXG4gICAgICB9KSxcclxuICAgICAgYnVmZmVyQ291bnQoTWF0aC5yb3VuZCh0aGlzLnNwZWVkIC8gYmV0d2VlblRpbWUpLCAwKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0QXV0b051bSgpIHtcclxuICAgIGNvbnN0IGluaXROdW0gPSAzO1xyXG4gICAgLy8gNjEwXHJcbiAgICBjb25zdCB3aWR0aCA9IHRoaXMucm9vdEVsbS5jbGllbnRXaWR0aDtcclxuICAgIGlmICh3aWR0aCA+IDMwMCkge1xyXG4gICAgICByZXR1cm4gTWF0aC5mbG9vcihpbml0TnVtICsgKHdpZHRoIC8gMjAwKSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaW5pdE51bTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkU3R5bGUoZWxtOiBIVE1MRWxlbWVudCwgc3R5bGU6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgbnVtYmVyIH0pIHtcclxuICAgIGlmIChzdHlsZSkge1xyXG4gICAgICBPYmplY3Qua2V5cyhzdHlsZSkuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBzdHlsZVtrZXldO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGVsbSwga2V5LCB2YWx1ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuIl19