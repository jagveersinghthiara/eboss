!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("resize-observer-polyfill"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@angular/forms")):"function"==typeof define&&define.amd?define("ngx-hm-carousel",["exports","@angular/core","resize-observer-polyfill","rxjs","rxjs/operators","@angular/common","@angular/forms"],e):e(t["ngx-hm-carousel"]={},t.ng.core,null,t.rxjs,t.rxjs.operators,t.ng.common,t.ng.forms)}(this,function(t,n,r,s,o,e,i){"use strict";r=r&&r.hasOwnProperty("default")?r["default"]:r;var a=function(){function t(t,e){this._view=t,this._template=e,this.compelete=!1,this._view.clear()}return Object.defineProperty(t.prototype,"currentI",{set:function(t){if(!this.compelete){var e=t+1,n=t-1;0!==this.index&&this.index!==this.length-1&&this.index!==e&&this.index!==n&&this.index!==t||(this._view.createEmbeddedView(this._template),this.compelete=!0)}},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){},t.decorators=[{type:n.Directive,args:[{selector:"[ngxHmCarouselDynamic]"}]}],t.ctorParameters=function(){return[{type:n.ViewContainerRef},{type:n.TemplateRef}]},t.propDecorators={index:[{type:n.Input,args:["ngxHmCarouselDynamic"]}],length:[{type:n.Input,args:["ngxHmCarouselDynamicLength"]}],currentI:[{type:n.Input,args:["ngxHmCarouselDynamicIndex"]}]},t}(),l=function(){function t(){this.clickEvent=new n.EventEmitter}return t.decorators=[{type:n.Directive,args:[{selector:"[ngx-hm-carousel-item]"}]}],t.ctorParameters=function(){return[]},t.propDecorators={clickEvent:[{type:n.Output,args:["ngx-hm-carousel-item"]}]},t}();function h(t,e,n){var i;return void 0===n&&(n=200),s.Observable.create(function(n){(i=new r(function(t,e){n.next(i)})).observe(t)}).pipe(o.debounceTime(n),o.tap(function(){e()}),o.finalize(function(){i.unobserve(t),i.disconnect()}))}var c=function(){function t(t,e){this.platformId=t,this._renderer=e,this.aniTime=400,this.align="center",this.infinite=!1,this.mourseEnable=!1,this.speed=5e3,this.delay=8e3,this.direction="right",this.scrollNum=1,this.isDragMany=!1,this.indexChanged=new n.EventEmitter,this.isFromAuto=!0,this._currentIndex=0,this._showNum=1,this.isAutoNum=!1,this._autoplay=!1,this._porgressWidth=0,this.alignDistance=0,this.lastIndex=0,this.elmWidth=0,this.container_left=0,this.mouseOnContainer=!1,this.restart=new s.BehaviorSubject(null),this.stopEvent=new s.Subject}return Object.defineProperty(t.prototype,"showNum",{get:function(){return this._showNum},set:function(t){"auto"===t?this.isAutoNum=!0:this._showNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(t){this.currentIndex!==t&&(this._currentIndex=t,this.itemsElm&&(this.autoplay&&!this.isFromAuto&&(this.stopEvent.next(),this.restart.next(null)),this.drawView(this.currentIndex))),this.isFromAuto=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoplay",{get:function(){return this._autoplay},set:function(t){e.isPlatformBrowser(this.platformId)&&this.itemsElm&&(this.progressWidth=0,t?this.doNextSub$=this.doNext.subscribe():this.doNextSub$&&this.doNextSub$.unsubscribe()),this._autoplay=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"progressWidth",{get:function(){return this._porgressWidth},set:function(t){this.progressElm!==undefined&&this.autoplay&&(this._porgressWidth=t)},enumerable:!0,configurable:!0}),t.prototype.ngAfterContentInit=function(){this.initVariable()},t.prototype.ngAfterViewInit=function(){var t=this;this.setViewWidth(!0),this.reSetVariable(),this.hammer=this.bindHammer(),this.drawView(this.currentIndex),this.bindClick(),(this.autoplay||this.infinite)&&this.addInfiniteElm(),this.elmSub$=h(this.rootElm,function(){return t.containerResize()}).subscribe()},t.prototype.addInfiniteElm=function(){this.firstElm_clone=this.itemsElm[this.lastIndex].cloneNode(!0),this.addStyle(this.firstElm_clone,{position:"absolute",transform:"translateX(-100%)"}),this.LatestElm_clone=this.itemsElm[0].cloneNode(!0),this.addStyle(this.LatestElm_clone,{position:"absolute",right:0,top:0,transform:"translateX(100%)"}),this._renderer.insertBefore(this.containerElm,this.firstElm_clone,this.itemsElm[0]),this._renderer.appendChild(this.containerElm,this.LatestElm_clone)},t.prototype.containerResize=function(){this.reSetVariable(),this.setViewWidth(),this.showNum>=this.itemsElm.length&&(this.currentIndex=0),this.drawView(this.currentIndex,!1)},t.prototype.ngOnDestroy=function(){this.btnNext&&this.btnPrev&&(this.nextListener(),this.prevListener()),this.hammer.destroy(),this.autoplay&&this.doNextSub$.unsubscribe(),this.elmSub$.unsubscribe()},t.prototype.setIndex=function(t){this.currentIndex=t},t.prototype.initVariable=function(){var t=this;this.rootElm=this.parentChild.nativeElement,this.containerElm=this.rootElm.children[0],this.itemsElm=Array.from(this.containerElm.children),this.lastIndex=this.itemsElm.length-1,this.dotElm&&(this.dots=new Array(this.itemsElm.length));var e=this.restart.asObservable(),n=this.stopEvent.asObservable();this.mourseEnable&&(e=s.merge(e,s.fromEvent(this.containerElm,"mouseleave").pipe(o.tap(function(){return t.mouseOnContainer=!1}))),n=s.merge(n,s.fromEvent(this.containerElm,"mouseover").pipe(o.tap(function(){return t.mouseOnContainer=!0})))),this.doNext=e.pipe(o.debounceTime(this.delay),o.switchMap(function(){return t.runProgress(20).pipe(o.tap(function(){t.isFromAuto=!0,"left"===t.direction?t.currentIndex-=t.scrollNum:t.currentIndex+=t.scrollNum}),o.takeUntil(n.pipe(o.tap(function(){return t.progressWidth=0}))))})),this.autoplay&&(this.doNextSub$=this.doNext.subscribe())},t.prototype.reSetVariable=function(){if(this.container_left=this.rootElm.getBoundingClientRect().left,this.showNum&&1!==this.showNum)switch(this.align){case"center":this.alignDistance=(this.rootElm.clientWidth-this.elmWidth)/2;break;case"left":this.alignDistance=0;break;case"right":this.alignDistance=this.rootElm.clientWidth-this.elmWidth}},t.prototype.setViewWidth=function(t){var n=this;this.isAutoNum&&(this._showNum=this.getAutoNum()),this._renderer.addClass(this.containerElm,"grab");t&&this._renderer.addClass(this.containerElm,"ngx-hm-carousel-display-npwrap"),this.elmWidth=(0+this.rootElm.clientWidth)/this._showNum,this._renderer.removeClass(this.containerElm,"ngx-hm-carousel-display-npwrap"),this._renderer.setStyle(this.containerElm,"width",this.elmWidth*this.itemsElm.length+"px"),this._renderer.setStyle(this.containerElm,"position","relative"),this.itemsElm.forEach(function(t,e){n._renderer.setStyle(t,"width",n.elmWidth+"px")}),this.firstElm_clone&&(this._renderer.setStyle(this.firstElm_clone,"width",this.elmWidth+"px"),this._renderer.setStyle(this.LatestElm_clone,"width",this.elmWidth+"px"))},t.prototype.bindHammer=function(){var r=this,t=new Hammer(this.containerElm);return t.get("pan").set({direction:Hammer.DIRECTION_HORIZONTAL}),t.on("panleft panright panend tap",function(t){switch(r._renderer.removeClass(r.containerElm,"transition"),r._renderer.addClass(r.containerElm,"grabbing"),r.autoplay&&r.stopEvent.next(),t.type){case"tap":r.callClick(t.center.x),r.callRestart(),r._renderer.removeClass(r.containerElm,"grabbing");break;case"panleft":case"panright":if(r.showNum>=r.itemsElm.length)return void r.hammer.stop(!0);if(r.prePanMove=!1,50<Math.abs(t.deltaY))return;r.autoplay||r.infinite||!r.outOfBound(t.type)||(t.deltaX*=.2),r._renderer.setStyle(r.containerElm,"left",-r.currentIndex*r.elmWidth+r.alignDistance+t.deltaX+"px"),r.isDragMany||Math.abs(t.deltaX)>.5*r.elmWidth&&(0<t.deltaX?r.currentIndex-=r.scrollNum:r.currentIndex+=r.scrollNum,r._renderer.removeClass(r.containerElm,"grabbing"),r.callRestart(),r.hammer.stop(!0),r.prePanMove=!0);break;case"panend":if(r.callRestart(),r._renderer.removeClass(r.containerElm,"grabbing"),Math.abs(t.deltaX)>.15*r.elmWidth){var e=r.isDragMany?Math.ceil(Math.abs(t.deltaX)/r.elmWidth):r.scrollNum,n=r.currentIndex-e,i=r.currentIndex+e;0<t.deltaX?(!r.autoplay&&!r.infinite&&n<0&&(n=0,r.drawView(0)),r.currentIndex=n):(!r.autoplay&&!r.infinite&&i>r.lastIndex-r._showNum+1&&(i=r.lastIndex-r._showNum+1,r.drawView(i)),r.currentIndex=i);break}!r.isDragMany&&r.prePanMove&&r.callClick(t.center.x),r.drawView(r.currentIndex),r.prePanMove=!1}}),t},t.prototype.bindClick=function(){var t=this;this.btnNext&&this.btnPrev&&(this.nextListener=this._renderer.listen(this.btnNext.nativeElement,"click",function(){t.currentIndex++}),this.prevListener=this._renderer.listen(this.btnPrev.nativeElement,"click",function(){t.currentIndex--}))},t.prototype.callRestart=function(){this.autoplay&&!this.mouseOnContainer&&this.restart.next(null)},t.prototype.callClick=function(t){var e=this.currentIndex+Math.floor((t-this.container_left-this.alignDistance)/this.elmWidth),n=this.items.toArray()[e];n&&n.clickEvent.emit(e)},t.prototype.drawView=function(t,e){void 0===e&&(e=!0);var n=this.lastIndex;if(this.autoplay||this.infinite?t<0?this._currentIndex=n:n<t&&(this._currentIndex=0):this._currentIndex=Math.max(0,Math.min(t,this.lastIndex)),1<this.itemsElm.length){var i=t*this.elmWidth-this.alignDistance;this._renderer.setStyle(this.containerElm,"left",-i+"px"),e?(this._renderer.addClass(this.containerElm,"transition"),this.indexChanged.emit(this.currentIndex)):this._renderer.removeClass(this.containerElm,"transition"),this.InfiniteHandler(t,n)}else this._renderer.setStyle(this.containerElm,"left",this.alignDistance+"px")},t.prototype.InfiniteHandler=function(e,n){var i=this;(this.autoplay||this.infinite)&&setTimeout(function(){i._renderer.removeClass(i.containerElm,"transition");var t=0;e<=-1?(t=n*i.elmWidth-i.alignDistance,i._renderer.setStyle(i.containerElm,"left",-t+"px")):n<e&&i._renderer.setStyle(i.containerElm,"left","0px")},this.aniTime)},t.prototype.outOfBound=function(t){switch(t){case"panleft":return this.currentIndex>=this.lastIndex-this._showNum+1;case"panright":return this.currentIndex<=0}},t.prototype.runProgress=function(t){var e=this,n=this.speed/t,i=100/this.speed*t;return s.interval(t).pipe(o.tap(function(t){e.progressWidth=t%n*i}),o.bufferCount(Math.round(this.speed/t),0))},t.prototype.getAutoNum=function(){var t=this.rootElm.clientWidth;return 300<t?Math.floor(3+t/200):3},t.prototype.addStyle=function(n,i){var r=this;i&&Object.keys(i).forEach(function(t){var e=i[t];r._renderer.setStyle(n,t,e)})},t.decorators=[{type:n.Component,args:[{selector:"ngx-hm-carousel",template:'<div #parentChild class="carousel">\n  <ng-content select="[ngx-hm-carousel-container]"></ng-content>\n  \x3c!-- left --\x3e\n  <div #prev *ngIf="contentPrev"\n    class="direction left">\n    <ng-container *ngTemplateOutlet="contentPrev"></ng-container>\n  </div>\n  \x3c!--  right --\x3e\n  <div #next *ngIf="contentNext"\n    class="direction right">\n    <ng-container *ngTemplateOutlet="contentNext"></ng-container>\n  </div>\n  \x3c!-- indicators --\x3e\n  <ul class="indicators" *ngIf="dotElm">\n    <li\n      *ngFor="let dot of dots; let i = index;"\n      (click)="setIndex(i)">\n      <ng-container\n        *ngTemplateOutlet="dotElm, context: {\n          $implicit: {\n            index : i,\n            currentIndex : currentIndex\n          }\n        }">\n      </ng-container>\n    </li>\n  </ul>\n  \x3c!-- progress --\x3e\n  <div *ngIf="progressElm && autoplay">\n    <ng-container\n      *ngTemplateOutlet="progressElm, context: {\n        $implicit: {\n          progress:progressWidth\n        }\n      }">\n    </ng-container>\n  </div>\n</div>\n',styles:[":host{display:block;height:100%}.ngx-hm-carousel-display-npwrap{display:flex!important;flex-wrap:nowrap!important;flex-direction:row!important;overflow:hidden!important}.carousel{overflow:hidden;position:relative;width:100%;height:100%}.carousel ul.indicators{list-style:none;bottom:1rem;left:0;margin:0;padding:0;position:absolute;text-align:center;width:100%}.carousel ul.indicators li{cursor:pointer;display:inline-block;position:relative;padding:.5rem}.carousel .direction{position:absolute;height:100%;display:flex;align-items:center;justify-content:center;top:0}.carousel .direction.left{left:0}.carousel .direction.right{position:absolute;right:0}.transition{transition:all .4s ease-in-out}.grab{cursor:-webkit-grab;cursor:grab}.grabbing{cursor:-webkit-grabbing;cursor:grabbing}.pointer{cursor:pointer}"],encapsulation:n.ViewEncapsulation.None}]}],t.ctorParameters=function(){return[{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]},{type:n.Renderer2}]},t.propDecorators={parentChild:[{type:n.ViewChild,args:["parentChild"]}],btnPrev:[{type:n.ViewChild,args:["prev"]}],btnNext:[{type:n.ViewChild,args:["next"]}],items:[{type:n.ContentChildren,args:[l]}],contentPrev:[{type:n.ContentChild,args:["carouselPrev"]}],contentNext:[{type:n.ContentChild,args:["carouselNext"]}],dotElm:[{type:n.ContentChild,args:["carouselDot"]}],progressElm:[{type:n.ContentChild,args:["carouselProgress"]}],aniTime:[{type:n.Input,args:["aniTime"]}],align:[{type:n.Input,args:["align"]}],infinite:[{type:n.Input,args:["infinite"]}],mourseEnable:[{type:n.Input,args:["mourse-enable"]}],speed:[{type:n.Input,args:["autoplay-speed"]}],delay:[{type:n.Input,args:["between-delay"]}],direction:[{type:n.Input,args:["autoplay-direction"]}],showNum:[{type:n.Input,args:["show-num"]}],scrollNum:[{type:n.Input,args:["scroll-num"]}],isDragMany:[{type:n.Input,args:["drag-many"]}],currentIndex:[{type:n.Input,args:["current-index"]}],autoplay:[{type:n.Input,args:["autoplay"]}],indexChanged:[{type:n.Output,args:["index-change"]}]},t}(),u=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule,i.FormsModule],declarations:[c,l,a],exports:[c,l,a]}]}],t}();t.NgxHmCarouselDynamicDirective=a,t.NgxHmCarouselItemDirective=l,t.NgxHmCarouselComponent=c,t.NgxHmCarouselModule=u,t.resizeObservable=h,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-hm-carousel.umd.min.js.map